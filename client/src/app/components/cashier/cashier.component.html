<div *ngIf="patients.length" class="modal" role="dialog" tabindex="-1" id="billingModal" style="border-radius:32px;max-width:841px;margin: auto;padding-top: 35px">
    <div style="max-width: 730px;border-radius:32px;" class="modal-dialog" role="document">
        <div class="modal-content" style="width:100%; height:400px;border-radius:32px;padding-left:0px;padding-right: 0px;">
            <div class="modal-body" style="border-radius:32px;padding: 0px;">
                <div class="card card-secondary historycard midlecard profilecard" style="margin:auto;min-height:400px;border-radius:32px;width:100%;position: absolute">
                  <div  data-dismiss="modal" style="height: 25px; width:25px; top:3%; cursor: pointer;  color: white(248, 248, 248); background:rgba(193, 193, 224, 0.2)" class="close-comment">
                    <i title="close" class="icon ion-ios-close-empty"></i>
                </div>
                <div style="height: 25px; left:79%; width:8px; top:13px; cursor: pointer; background: white;  color: doggerblue;
                " class="close-comment">
                    <i *ngIf = '!billing' (click) = switchBilling() title="Add Bills" class="icon ion-ios-plus-empty"></i>
                </div>
                <div style='padding-left: 37px;border-top-right-radius:32px;border-top-left-radius:32px;border-bottom: 0px;height:40px;margin-bottom: 15px;' class="card-header profileheader small-header">
                  <i  *ngIf = 'billing' (click) = switchBilling()  style='position:absolute;  left:3%;top: 16px; cursor:pointer;
                  display: inline-block; color:#1da1f2;' title="Back" class="icon ion-android-arrow-back">
                  </i>
                    <div style="left:44px;top:13px" class="timeline lastdoc priscriber headerdp small-dp">
                        <img [src]=getDp(patients[curIndex].info.personal.avatar)/>
                    </div>
                    <p style="top:5px;left:15px"  href="#" class="patien-name small-name">
                    {{patients[curIndex]?.info.personal.firstName +' '+ patients[curIndex].info.personal.lastName}}<span class="small-headericon"></span>
                    </p>
                    <h6 style='font-size:11px; font-weight:bold; position:absolute;color:dodgerblue;top:5%;left:70%' class="patien-name small-name">BILLS</h6>
                </div>
                    <div *ngIf='!billing && !cardView.editing' class="card-body orderbody" style=" width:55%; margin:auto;">
                        <div style="border-left:2px solid #1da1f2;height:290px; width:100%;">
                            <div style='border:none' *ngFor="let invoice of invoices; let i = index" class="carditem priscriptioncontainer order">
                                <div style='left:-3%' class="timeline condition drugtimeline">
                                    <p class="timelinedate">{{invoice[0]?.stamp.dateAdded|date:'dd'}}</p>
                                    <p class="timelinedate month">{{invoice[0]?.stamp.dateAdded|date:'MMM'|uppercase}}</p>
                                </div>
                                <div *ngFor="let item of invoice; let j = index" class="priscription drug">
                                <h6 class="dept">{{item.name}}&nbsp;
                                    <span *ngIf="item.paid" class="predata priceval">
                                        <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                                    </span>
                                    <span *ngIf="!item.paid" class="predata priceval">
                                        <i title = 'Deselect' (click)="selectItem(i,j)" style=' color:lightgrey;'  *ngIf="item.stamp.selected"
                                        class="icon ion-ios-checkmark-empty paid-icon" ></i>
                                        <!-- <div  style='border-color:rgb(228, 227, 227)'
                                        *ngIf="!invoice.price" class="mycheckbox">
                                        </div> -->
                                        <div title = 'Select' class="mycheckbox" *ngIf="!item.stamp.selected" (click)="selectItem(i,j)">
                                        </div>
                                    </span>
                                    </h6>
                                    <h6 class="dept previnfo">Description&nbsp;
                                        <span class="predata">
                                        {{item.desc}}&nbsp;|&nbsp;</span>
                                        <span class="predata">{{item.stamp.dateAdded|date:'hh:mma'|lowercase}}</span></h6>
                                    <h6 class="dept previnfo" style="color:lightgrey">Price&nbsp;
                                        <span [ngStyle]='getStyle(item)'
                                        style="text-align:right;
                                        left:84%;display:inline-block;width:50px" *ngIf='item.price '
                                        class="predata priceval">{{item.price * item.quantity}}
                                        </span>
                                        <span *ngIf='!item.price' class="predata priceval">---</span>
                                    </h6>
                                </div>
                            </div>
                        </div>
                        <!-- <p class="credits">CREDITS :
                            <span>{{credit.price||0}}</span>
                            <span>
                                <div title="Mark" style='position: absolute;bottom:1px; left:70%;' class="mycheckbox"></div>
                            </span>
                        </p> -->
                    </div>
                    <div *ngIf='cardView.editing' class="card-body orderbody" style="width:65%;margin:auto;">
                        <form style="top:15%;" class=" staffsform">
                            <div style="top:1px; margin-bottom:25px; min-height: 80px;max-height: 120;" class="form-group">
                                <table *ngIf="edited.length" cellspacing="0" class="data-table drugs-table" style="width:100%;left:0%;">
                                    <thead class='productHead'>
                                        <tr style="padding-left: 4px" class="staff-th">
                                            <th style="padding:3px 8px;font-weight: bold;font-size:12px;color:dodgerblue;" class="headlbl staff-th">BILL</th>
                                            <th style='text-align:right;padding:3px 8px;font-size:12px; font-weight: bold;color:dodgerblue;' class="headlbl staff-th">PRICE</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let invoice of edited; let i = index; let odd = odd;"
                                        style="border-bottom:2px solid white;"
                                        [class.even]=odd class="ro staff-row">
                                            <td style="padding:2px 4px; " class="data"> {{invoice.name}}</td>
                                            <td style='font-size:11px;text-align:right;padding:2px 6px;'
                                            class="data">
                                            <span class='t_span'>
                                              <input [(ngModel)]="edited[i].price" [ngModelOptions] = {standalone:true}
                                               class="form-control inputs t_input">
                                            </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot class="t__footer" col-span='4'>Total: <span>{{getPriceTotal()}}</span></tfoot>
                                </table>
                            </div>
                            <button (click)='comfirmPayment()'
                                style="width: 170px;font-size: 12px; height:27px;left:28%; bottom:-94%;"
                                class="btn btn-sm btn-outline-primary mainbtn">Comfirm Payment
                                <span style="position: absolute; bottom: -7%;left: 80%;">
                                    <i *ngIf="processing" class="fa fa-circle-o-notch fa-spin fa-10x slow-spin "
                                    style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;"> </i>
                                </span>
                            </button>
                        </form>
                    </div>
                    <div *ngIf='billing' class="card-body orderbody" style="width:55%;margin:auto;">
                        <form style="top:15%;" class=" staffsform">
                                <div class="form-group">
                                      <label style='font-size:8px;left: 25px;top:-15%;' for="desc" class="labelss complain">DESCPRICTION
                                      </label>
                                      <input placeholder = 'Invoice description' autocomplete ='off' [(ngModel)]='invoice.name' name="desc" class="form-control  input ">
                                  </div>
                                  <div class ='group-wrap'>
                                    <div class="form-group">
                                        <label style="font-size:8px" for="dos" class="labelss complain">PRICE</label>
                                        <input type = number min = 0 autocomplete ='off' [(ngModel)]='invoice.price'  name="price" class="form-control input first"/>
                                    </div>
                                    <div class="form-group submit-group">
                                        <label style="font-size:8px" for="dept" class="labelss complain">DEPARTMENT</label>
                                        <select [ngModel]='invoice.desc' id = select autocomplete ='off'   name="dept"  autocomplete="off" class=" form-control input select last" name="bedno">
                                            <option>Pharmacy</option>
                                            <option>Lab</option>
                                            <option>Others</option>
                                        </select>
                                        <button class="btn btn-outline-primary">
                                            <i *ngIf = 'invoice.name && invoice.price && invoice.desc'title = "Add Invoice" (click)='addInvoice()'
                                            class="icon ion-ios-plus-empty arrow "></i>
                                        </button>
                                    </div>
                                  </div>

                                  <div *ngIf='bills.length' class="form-group vitals-section setGroup">
                                      <table cellspacing="0" class="data-table drugs-table" style="width:100%;left:0%;" summary="List of all items in store. ">
                                        <thead class='productHead'>
                                            <tr class="patient-th">
                                                <th style='padding: 4px;font-size:10px;color: #6c757d;font-weight:bold' class="headlbl patient-th">DESCRIPTION</th>
                                                <th style='padding: 4px;font-size:10px;text-align: right; color: #6c757d;font-weight:bold' class="headlbl patient-th">PRICE</th>
                                                <!-- <th style='padding: 4px;font-size:10px;text-align: right; color: #6c757d;font-weight:bold' class="headlbl patient-th">DEPARTMENT</th> -->
                                                <th style='padding: 4px;font-size:10px;color: #6c757d;' class="headlbl patient-th"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr style="border-bottom: 1px solid #f8f9fa;" *ngFor='let b of bills; let i = index; let odd = odd' class="ro patient-row">
                                                <td style="padding:0px;padding-left:4px;" class="data">
                                                    {{b.name}}
                                                </td>
                                                <td style="padding:0px;text-align: right;padding-left:4px;" class="data">
                                                    {{b.price}}
                                                </td>
                                                <!-- <td style="padding:0px;text-align: right;padding-left:4px;" class="data">
                                                    {{b.dept}}
                                                </td> -->
                                                <td style='padding:0px; padding-left:3px;text-align: center' class="data">
                                                    <i (click)='removeBill(i)' class="icon ion-ios-trash-outline tableicon" title="Discard" style="font-size:15px; cursor: pointer;"></i>
                                                </td>
                                            </tr>
                                        </tbody>
                                  </table>
                              </div>
                          </form>
                           <button [disabled]='!bills.length' (click)='addBills()' style=" width: 170px;font-size: 10px; height:27px;left:28%; bottom:20%;" class="btn btn-sm btn-outline-primary mainbtn">ADD INVOICE
                                <span style="position: absolute; bottom: -7%;left: 80%;">
                                <i *ngIf="processing" class="fa fa-circle-o-notch fa-spin fa-10x slow-spin " style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;"> </i>
                                </span>
                          </button>
                      </div>
                    <div *ngIf='cardView.editing || cardView.reversing' style="left:7%; top:45%;position: absolute;
                        width: 7%;" class="btn-group disposition">
                        <button (click)="switchViews('orders')" style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo shift-button" >
                            <i  style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Back" class="icon ion-android-arrow-back">
                            </i>
                        </button>
                    </div>
                    <div *ngIf='cardView.orders && invoiceSelcted()' style="left:80%; top:45%;position: absolute;
                    width: 7%;" class="btn-group disposition">
                        <button (click)='switchToEdit()' style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo shift-button" >
                            <i   style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Go to payment" class="icon ion-android-arrow-forward ">
                            </i>
                        </button>
                    </div>
                    <h6 *ngIf="successMsg" class="feedbackMsg">{{successMsg}}</h6>
                    <h6 *ngIf="errorMsg"  style="color: red" class="feedbackMsg">{{errorMsg}}</h6>
                </div>
            </div>
        </div>
    </div>
</div>









<header class="header-main">
  <nav>
    <div class="logo-box">
      <svg width="30" height="28" viewBox="0 0 30 28" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M27.167 14C27.167 21.4615 21.1918 27.5 13.8335 27.5C6.47523 27.5 0.5 21.4615 0.5 14C0.5 6.5385 6.47523 0.5 13.8335 0.5C21.1918 0.5 27.167 6.5385 27.167 14Z" stroke="#1E90FF"/>
        <path d="M29.5002 8.08895C29.5002 10.2347 27.8239 11.9445 25.7921 11.9445C23.7603 11.9445 22.084 10.2347 22.084 8.08895C22.084 5.94322 23.7603 4.2334 25.7921 4.2334C27.8239 4.2334 29.5002 5.94322 29.5002 8.08895Z" fill="#1E90FF" stroke="#1E90FF"/>
        <path d="M13.1445 15.2764C12.6113 14.9528 12.2193 14.6247 11.9687 14.292C11.718 13.9593 11.5836 13.5264 11.5654 12.9932C11.5654 12.9339 11.5654 12.9043 11.5654 12.9043C11.5654 12.9043 11.6565 12.9043 11.8388 12.9043C12.0165 12.9043 12.1054 12.9043 12.1054 12.9043C12.1054 12.9043 12.1054 12.9271 12.1054 12.9727C12.1236 13.3646 12.2262 13.6882 12.413 13.9434C12.5999 14.1986 12.9348 14.4766 13.4179 14.7773C13.5273 14.8411 13.582 14.873 13.582 14.873C13.582 14.873 13.5387 14.9505 13.4521 15.1055C13.3518 15.2741 13.3017 15.3584 13.3017 15.3584C13.3017 15.3584 13.2493 15.3311 13.1445 15.2764ZM13.4179 14.7773C12.9348 14.4766 12.5999 14.1986 12.413 13.9434C12.2262 13.6882 12.1236 13.3646 12.1054 12.9727C12.1054 12.9271 12.1054 12.9043 12.1054 12.9043C12.1054 12.9043 12.1943 12.9043 12.372 12.9043C12.5543 12.9043 12.6454 12.9043 12.6454 12.9043C12.6454 12.9043 12.6454 12.9202 12.6454 12.9521C12.6637 13.2347 12.7411 13.4671 12.8779 13.6494C13.0146 13.8317 13.2903 14.0482 13.705 14.2988C13.8098 14.3581 13.8622 14.3877 13.8622 14.3877C13.8622 14.3877 13.8144 14.472 13.7187 14.6406C13.6275 14.7956 13.582 14.873 13.582 14.873C13.582 14.873 13.5273 14.8411 13.4179 14.7773ZM11.8388 12.7676C11.6565 12.7676 11.5654 12.7676 11.5654 12.7676C11.5654 12.7676 11.5676 12.738 11.5722 12.6787C11.6223 12.0361 11.8958 11.5052 12.3925 11.0859C12.8893 10.6667 13.4817 10.432 14.1699 10.3818C14.2701 10.3727 14.3202 10.3682 14.3202 10.3682C14.3202 10.3682 14.3202 10.4525 14.3202 10.6211C14.3202 10.776 14.3202 10.8535 14.3202 10.8535C14.3202 10.8535 14.277 10.8558 14.1904 10.8604C13.6754 10.8968 13.2128 11.0791 12.8027 11.4072C12.3971 11.7354 12.1669 12.1637 12.1122 12.6924C12.1077 12.7425 12.1054 12.7676 12.1054 12.7676C12.1054 12.7676 12.0165 12.7676 11.8388 12.7676ZM12.372 12.7676C12.1943 12.7676 12.1054 12.7676 12.1054 12.7676C12.1054 12.7676 12.1077 12.7425 12.1122 12.6924C12.1669 12.1637 12.3971 11.7354 12.8027 11.4072C13.2128 11.0791 13.6754 10.8968 14.1904 10.8604C14.277 10.8558 14.3202 10.8535 14.3202 10.8535C14.3202 10.8535 14.3202 10.9447 14.3202 11.127C14.3202 11.3001 14.3202 11.3867 14.3202 11.3867C14.3202 11.3867 14.2929 11.3867 14.2382 11.3867C13.7962 11.4095 13.427 11.5417 13.1308 11.7832C12.8346 12.0202 12.6728 12.3255 12.6454 12.6992C12.6454 12.7448 12.6454 12.7676 12.6454 12.7676C12.6454 12.7676 12.5543 12.7676 12.372 12.7676ZM13.6093 19.7744C13.582 19.7744 13.5683 19.7744 13.5683 19.7744C13.5683 19.7744 13.5683 19.6947 13.5683 19.5352C13.5683 19.362 13.5683 19.2754 13.5683 19.2754C13.5683 19.2754 13.582 19.2754 13.6093 19.2754C14.1471 19.2389 14.5937 19.0794 14.9492 18.7969C15.3046 18.5143 15.4915 18.1383 15.5097 17.6689C15.5097 17.637 15.5097 17.6211 15.5097 17.6211C15.5097 17.6211 15.6008 17.6211 15.7831 17.6211C15.9609 17.6211 16.0497 17.6211 16.0497 17.6211C16.0497 17.6211 16.0475 17.6462 16.0429 17.6963C15.9973 18.3115 15.7512 18.8037 15.3046 19.1729C14.8626 19.542 14.2975 19.7425 13.6093 19.7744ZM13.7119 20.2598C13.6161 20.2643 13.5683 20.2666 13.5683 20.2666C13.5683 20.2666 13.5683 20.18 13.5683 20.0068C13.5683 19.8519 13.5683 19.7744 13.5683 19.7744C13.5683 19.7744 13.582 19.7744 13.6093 19.7744C14.2975 19.7425 14.8626 19.542 15.3046 19.1729C15.7512 18.8037 15.9973 18.3115 16.0429 17.6963C16.0475 17.6462 16.0497 17.6211 16.0497 17.6211C16.0497 17.6211 16.1386 17.6211 16.3163 17.6211C16.4986 17.6211 16.5898 17.6211 16.5898 17.6211C16.5898 17.6211 16.5875 17.653 16.5829 17.7168C16.5191 18.4915 16.2138 19.1022 15.6669 19.5488C15.1201 19.9909 14.4684 20.2279 13.7119 20.2598ZM15.7831 17.4092C15.6008 17.4092 15.5097 17.4092 15.5097 17.4092C15.5097 17.4092 15.5074 17.3773 15.5029 17.3135C15.4573 17.04 15.3502 16.8031 15.1816 16.6025C15.013 16.3975 14.7304 16.1833 14.3339 15.96C14.2428 15.9053 14.1972 15.8779 14.1972 15.8779C14.1972 15.8779 14.2428 15.8005 14.3339 15.6455C14.4296 15.4723 14.4775 15.3857 14.4775 15.3857C14.4775 15.3857 14.5436 15.4245 14.6757 15.502C15.1132 15.748 15.4413 15.9987 15.6601 16.2539C15.8788 16.5091 16.0087 16.8577 16.0497 17.2998C16.0497 17.3727 16.0497 17.4092 16.0497 17.4092C16.0497 17.4092 15.9609 17.4092 15.7831 17.4092ZM16.3027 17.4092C16.1341 17.4092 16.0497 17.4092 16.0497 17.4092C16.0497 17.4092 16.0497 17.3727 16.0497 17.2998C16.0087 16.8577 15.8788 16.5091 15.6601 16.2539C15.4413 15.9987 15.1132 15.748 14.6757 15.502C14.5436 15.4245 14.4775 15.3857 14.4775 15.3857C14.4775 15.3857 14.5253 15.3037 14.621 15.1396C14.7122 14.9847 14.7577 14.9072 14.7577 14.9072C14.7577 14.9072 14.8261 14.946 14.9628 15.0234C15.4277 15.2695 15.8059 15.5863 16.0976 15.9736C16.3938 16.361 16.5556 16.7939 16.5829 17.2725C16.5875 17.3636 16.5898 17.4092 16.5898 17.4092C16.5898 17.4092 16.4941 17.4092 16.3027 17.4092ZM11.8388 12.9043C11.6565 12.9043 11.5654 12.9043 11.5654 12.9043C11.5654 12.9043 11.5654 12.8929 11.5654 12.8701C11.5654 12.8473 11.5654 12.8359 11.5654 12.8359C11.5654 12.8359 11.6565 12.8359 11.8388 12.8359C12.0165 12.8359 12.1054 12.8359 12.1054 12.8359C12.1054 12.8359 12.1054 12.8473 12.1054 12.8701C12.1054 12.8929 12.1054 12.9043 12.1054 12.9043C12.1054 12.9043 12.0165 12.9043 11.8388 12.9043ZM11.8388 12.8359C11.6565 12.8359 11.5654 12.8359 11.5654 12.8359C11.5654 12.8359 11.5654 12.8245 11.5654 12.8018C11.5654 12.779 11.5654 12.7676 11.5654 12.7676C11.5654 12.7676 11.6565 12.7676 11.8388 12.7676C12.0165 12.7676 12.1054 12.7676 12.1054 12.7676C12.1054 12.7676 12.1054 12.779 12.1054 12.8018C12.1054 12.8245 12.1054 12.8359 12.1054 12.8359C12.1054 12.8359 12.0165 12.8359 11.8388 12.8359ZM12.372 12.9043C12.1943 12.9043 12.1054 12.9043 12.1054 12.9043C12.1054 12.9043 12.1054 12.8929 12.1054 12.8701C12.1054 12.8473 12.1054 12.8359 12.1054 12.8359C12.1054 12.8359 12.1943 12.8359 12.372 12.8359C12.5543 12.8359 12.6454 12.8359 12.6454 12.8359C12.6454 12.8359 12.6454 12.8473 12.6454 12.8701C12.6454 12.8929 12.6454 12.9043 12.6454 12.9043C12.6454 12.9043 12.5543 12.9043 12.372 12.9043ZM12.372 12.8359C12.1943 12.8359 12.1054 12.8359 12.1054 12.8359C12.1054 12.8359 12.1054 12.8245 12.1054 12.8018C12.1054 12.779 12.1054 12.7676 12.1054 12.7676C12.1054 12.7676 12.1943 12.7676 12.372 12.7676C12.5543 12.7676 12.6454 12.7676 12.6454 12.7676C12.6454 12.7676 12.6454 12.779 12.6454 12.8018C12.6454 12.8245 12.6454 12.8359 12.6454 12.8359C12.6454 12.8359 12.5543 12.8359 12.372 12.8359ZM12.9394 20.2529C12.6751 20.2301 12.5429 20.2188 12.5429 20.2188C12.5429 20.2188 12.5429 20.1367 12.5429 19.9727C12.5429 19.8086 12.5429 19.7266 12.5429 19.7266C12.5429 19.7266 12.6728 19.738 12.9326 19.7607C13.1741 19.7699 13.2949 19.7744 13.2949 19.7744C13.2949 19.7744 13.2949 19.8519 13.2949 20.0068C13.2949 20.18 13.2949 20.2666 13.2949 20.2666C13.2949 20.2666 13.1764 20.262 12.9394 20.2529ZM12.9326 19.7607C12.6728 19.738 12.5429 19.7266 12.5429 19.7266C12.5429 19.7266 12.5429 19.6423 12.5429 19.4736C12.5429 19.3005 12.5429 19.2139 12.5429 19.2139C12.5429 19.2139 12.6751 19.2275 12.9394 19.2549C13.1764 19.2686 13.2949 19.2754 13.2949 19.2754C13.2949 19.2754 13.2949 19.362 13.2949 19.5352C13.2949 19.6947 13.2949 19.7744 13.2949 19.7744C13.2949 19.7744 13.1741 19.7699 12.9326 19.7607ZM13.3564 20.2666C13.3154 20.2666 13.2949 20.2666 13.2949 20.2666C13.2949 20.2666 13.2949 20.18 13.2949 20.0068C13.2949 19.8519 13.2949 19.7744 13.2949 19.7744C13.2949 19.7744 13.3176 19.7744 13.3632 19.7744C13.4088 19.7744 13.4316 19.7744 13.4316 19.7744C13.4316 19.7744 13.4316 19.8519 13.4316 20.0068C13.4316 20.18 13.4316 20.2666 13.4316 20.2666C13.4316 20.2666 13.4065 20.2666 13.3564 20.2666ZM13.3632 19.7744C13.3176 19.7744 13.2949 19.7744 13.2949 19.7744C13.2949 19.7744 13.2949 19.6947 13.2949 19.5352C13.2949 19.362 13.2949 19.2754 13.2949 19.2754C13.2949 19.2754 13.3176 19.2754 13.3632 19.2754C13.4088 19.2754 13.4316 19.2754 13.4316 19.2754C13.4316 19.2754 13.4316 19.362 13.4316 19.5352C13.4316 19.6947 13.4316 19.7744 13.4316 19.7744C13.4316 19.7744 13.4088 19.7744 13.3632 19.7744ZM13.4999 20.2666C13.4544 20.2666 13.4316 20.2666 13.4316 20.2666C13.4316 20.2666 13.4316 20.18 13.4316 20.0068C13.4316 19.8519 13.4316 19.7744 13.4316 19.7744C13.4316 19.7744 13.4544 19.7744 13.4999 19.7744C13.5455 19.7744 13.5683 19.7744 13.5683 19.7744C13.5683 19.7744 13.5683 19.8519 13.5683 20.0068C13.5683 20.18 13.5683 20.2666 13.5683 20.2666C13.5683 20.2666 13.5455 20.2666 13.4999 20.2666ZM13.4999 19.7744C13.4544 19.7744 13.4316 19.7744 13.4316 19.7744C13.4316 19.7744 13.4316 19.6947 13.4316 19.5352C13.4316 19.362 13.4316 19.2754 13.4316 19.2754C13.4316 19.2754 13.4544 19.2754 13.4999 19.2754C13.5455 19.2754 13.5683 19.2754 13.5683 19.2754C13.5683 19.2754 13.5683 19.362 13.5683 19.5352C13.5683 19.6947 13.5683 19.7744 13.5683 19.7744C13.5683 19.7744 13.5455 19.7744 13.4999 19.7744ZM14.3886 11.3867C14.343 11.3867 14.3202 11.3867 14.3202 11.3867C14.3202 11.3867 14.3202 11.2979 14.3202 11.1201C14.3202 10.9424 14.3202 10.8535 14.3202 10.8535C14.3202 10.8535 14.343 10.8535 14.3886 10.8535C14.4342 10.8535 14.457 10.8535 14.457 10.8535C14.457 10.8535 14.457 10.9424 14.457 11.1201C14.457 11.2979 14.457 11.3867 14.457 11.3867C14.457 11.3867 14.4342 11.3867 14.3886 11.3867ZM14.3886 10.8535C14.343 10.8535 14.3202 10.8535 14.3202 10.8535C14.3202 10.8535 14.3202 10.776 14.3202 10.6211C14.3202 10.4525 14.3202 10.3682 14.3202 10.3682C14.3202 10.3682 14.343 10.3682 14.3886 10.3682C14.4342 10.3682 14.457 10.3682 14.457 10.3682C14.457 10.3682 14.457 10.4525 14.457 10.6211C14.457 10.776 14.457 10.8535 14.457 10.8535C14.457 10.8535 14.4342 10.8535 14.3886 10.8535ZM14.5253 11.3867C14.4798 11.3867 14.457 11.3867 14.457 11.3867C14.457 11.3867 14.457 11.2979 14.457 11.1201C14.457 10.9424 14.457 10.8535 14.457 10.8535C14.457 10.8535 14.4798 10.8535 14.5253 10.8535C14.5709 10.8535 14.5937 10.8535 14.5937 10.8535C14.5937 10.8535 14.5937 10.9424 14.5937 11.1201C14.5937 11.3024 14.5937 11.3936 14.5937 11.3936C14.5937 11.3936 14.5709 11.3913 14.5253 11.3867ZM14.5253 10.8535C14.4798 10.8535 14.457 10.8535 14.457 10.8535C14.457 10.8535 14.457 10.776 14.457 10.6211C14.457 10.4525 14.457 10.3682 14.457 10.3682C14.457 10.3682 14.482 10.3682 14.5322 10.3682C14.5732 10.3682 14.5937 10.3682 14.5937 10.3682C14.5937 10.3682 14.5937 10.4525 14.5937 10.6211C14.5937 10.776 14.5937 10.8535 14.5937 10.8535C14.5937 10.8535 14.5709 10.8535 14.5253 10.8535ZM14.7919 11.4209C14.6598 11.4027 14.5937 11.3936 14.5937 11.3936C14.5937 11.3936 14.5937 11.3047 14.5937 11.127C14.5937 10.9447 14.5937 10.8535 14.5937 10.8535C14.5937 10.8535 14.662 10.8649 14.7988 10.8877C14.9309 10.9242 14.997 10.9424 14.997 10.9424C14.997 10.9424 14.997 11.0267 14.997 11.1953C14.997 11.3822 14.997 11.4756 14.997 11.4756C14.997 11.4756 14.9286 11.4574 14.7919 11.4209ZM14.7988 10.8877C14.662 10.8649 14.5937 10.8535 14.5937 10.8535C14.5937 10.8535 14.5937 10.776 14.5937 10.6211C14.5937 10.4525 14.5937 10.3682 14.5937 10.3682C14.5937 10.3682 14.6598 10.3704 14.7919 10.375C14.9286 10.3932 14.997 10.4023 14.997 10.4023C14.997 10.4023 14.997 10.4958 14.997 10.6826C14.997 10.8558 14.997 10.9424 14.997 10.9424C14.997 10.9424 14.9309 10.9242 14.7988 10.8877ZM15.7831 17.6211C15.6008 17.6211 15.5097 17.6211 15.5097 17.6211C15.5097 17.6211 15.5097 17.6029 15.5097 17.5664C15.5097 17.5345 15.5097 17.5186 15.5097 17.5186C15.5097 17.5186 15.6008 17.5186 15.7831 17.5186C15.9609 17.5186 16.0497 17.5186 16.0497 17.5186C16.0497 17.5186 16.0497 17.5345 16.0497 17.5664C16.0497 17.6029 16.0497 17.6211 16.0497 17.6211C16.0497 17.6211 15.9609 17.6211 15.7831 17.6211ZM15.7831 17.5186C15.6008 17.5186 15.5097 17.5186 15.5097 17.5186C15.5097 17.5186 15.5097 17.5003 15.5097 17.4639C15.5097 17.4274 15.5097 17.4092 15.5097 17.4092C15.5097 17.4092 15.6008 17.4092 15.7831 17.4092C15.9609 17.4092 16.0497 17.4092 16.0497 17.4092C16.0497 17.4092 16.0497 17.4274 16.0497 17.4639C16.0497 17.5003 16.0497 17.5186 16.0497 17.5186C16.0497 17.5186 15.9609 17.5186 15.7831 17.5186ZM16.3163 17.6211C16.1386 17.6211 16.0497 17.6211 16.0497 17.6211C16.0497 17.6211 16.0497 17.6029 16.0497 17.5664C16.0497 17.5345 16.0497 17.5186 16.0497 17.5186C16.0497 17.5186 16.1386 17.5186 16.3163 17.5186C16.4986 17.5186 16.5898 17.5186 16.5898 17.5186C16.5898 17.5186 16.5898 17.5345 16.5898 17.5664C16.5898 17.6029 16.5898 17.6211 16.5898 17.6211C16.5898 17.6211 16.4986 17.6211 16.3163 17.6211ZM16.3163 17.5186C16.1386 17.5186 16.0497 17.5186 16.0497 17.5186C16.0497 17.5186 16.0497 17.5003 16.0497 17.4639C16.0497 17.4274 16.0497 17.4092 16.0497 17.4092C16.0497 17.4092 16.1386 17.4092 16.3163 17.4092C16.4986 17.4092 16.5898 17.4092 16.5898 17.4092C16.5898 17.4092 16.5898 17.4274 16.5898 17.4639C16.5898 17.5003 16.5898 17.5186 16.5898 17.5186C16.5898 17.5186 16.4986 17.5186 16.3163 17.5186ZM11.7021 20.0547C11.5152 19.9818 11.4218 19.9453 11.4218 19.9453C11.4218 19.9453 11.4218 19.8473 11.4218 19.6514C11.4218 19.4736 11.4218 19.3848 11.4218 19.3848C11.4218 19.3848 11.5152 19.4303 11.7021 19.5215C11.8889 19.5853 11.9824 19.6172 11.9824 19.6172C11.9824 19.6172 11.9824 19.6969 11.9824 19.8564C11.9824 20.0387 11.9824 20.1299 11.9824 20.1299C11.9824 20.1299 11.8889 20.1048 11.7021 20.0547ZM11.7021 19.5215C11.5152 19.4303 11.4218 19.3848 11.4218 19.3848C11.4218 19.3848 11.4218 19.2731 11.4218 19.0498C11.4218 18.8903 11.4218 18.8105 11.4218 18.8105C11.4218 18.8105 11.5198 18.863 11.7158 18.9678C11.8935 19.0407 11.9824 19.0771 11.9824 19.0771C11.9824 19.0771 11.9824 19.1546 11.9824 19.3096C11.9824 19.5146 11.9824 19.6172 11.9824 19.6172C11.9824 19.6172 11.8889 19.5853 11.7021 19.5215ZM12.2626 20.1846C12.0758 20.1481 11.9824 20.1299 11.9824 20.1299C11.9824 20.1299 11.9824 20.0387 11.9824 19.8564C11.9824 19.6969 11.9824 19.6172 11.9824 19.6172C11.9824 19.6172 12.0735 19.6377 12.2558 19.6787C12.4472 19.7106 12.5429 19.7266 12.5429 19.7266C12.5429 19.7266 12.5429 19.8086 12.5429 19.9727C12.5429 20.1367 12.5429 20.2188 12.5429 20.2188C12.5429 20.2188 12.4495 20.2074 12.2626 20.1846ZM12.2558 19.6787C12.0735 19.6377 11.9824 19.6172 11.9824 19.6172C11.9824 19.6172 11.9824 19.5146 11.9824 19.3096C11.9824 19.1546 11.9824 19.0771 11.9824 19.0771C11.9824 19.0771 12.0781 19.1068 12.2695 19.166C12.4518 19.1979 12.5429 19.2139 12.5429 19.2139C12.5429 19.2139 12.5429 19.3005 12.5429 19.4736C12.5429 19.6423 12.5429 19.7266 12.5429 19.7266C12.5429 19.7266 12.4472 19.7106 12.2558 19.6787ZM15.291 11.5781C15.095 11.5098 14.997 11.4756 14.997 11.4756C14.997 11.4756 14.997 11.389 14.997 11.2158C14.997 11.0335 14.997 10.9424 14.997 10.9424C14.997 10.9424 15.0927 10.9697 15.2841 11.0244C15.4664 11.0882 15.5576 11.1201 15.5576 11.1201C15.5576 11.1201 15.5576 11.2135 15.5576 11.4004C15.5576 11.5964 15.5576 11.6943 15.5576 11.6943C15.5576 11.6943 15.4687 11.6556 15.291 11.5781ZM15.2841 11.0244C15.0927 10.9697 14.997 10.9424 14.997 10.9424C14.997 10.9424 14.997 10.8604 14.997 10.6963C14.997 10.5003 14.997 10.4023 14.997 10.4023C14.997 10.4023 15.0904 10.4251 15.2773 10.4707C15.4641 10.5254 15.5576 10.5527 15.5576 10.5527C15.5576 10.5527 15.5576 10.6462 15.5576 10.833C15.5576 11.0244 15.5576 11.1201 15.5576 11.1201C15.5576 11.1201 15.4664 11.0882 15.2841 11.0244ZM15.8242 11.8379C15.6464 11.7422 15.5576 11.6943 15.5576 11.6943C15.5576 11.6943 15.5576 11.5964 15.5576 11.4004C15.5576 11.2135 15.5576 11.1201 15.5576 11.1201C15.5576 11.1201 15.651 11.1589 15.8378 11.2363C16.0247 11.3275 16.1181 11.373 16.1181 11.373C16.1181 11.373 16.1181 11.4596 16.1181 11.6328C16.1181 11.8971 16.1181 12.0293 16.1181 12.0293C16.1181 12.0293 16.0201 11.9655 15.8242 11.8379ZM15.8378 11.2363C15.651 11.1589 15.5576 11.1201 15.5576 11.1201C15.5576 11.1201 15.5576 11.0244 15.5576 10.833C15.5576 10.6462 15.5576 10.5527 15.5576 10.5527C15.5576 10.5527 15.651 10.5892 15.8378 10.6621C16.0247 10.7441 16.1181 10.7852 16.1181 10.7852C16.1181 10.7852 16.1181 10.874 16.1181 11.0518C16.1181 11.266 16.1181 11.373 16.1181 11.373C16.1181 11.373 16.0247 11.3275 15.8378 11.2363ZM14.3408 15.6318C14.2451 15.7959 14.1972 15.8779 14.1972 15.8779C14.1972 15.8779 14.1243 15.8346 13.9785 15.748C13.8281 15.6615 13.7529 15.6182 13.7529 15.6182C13.7529 15.6182 13.7984 15.5361 13.8896 15.3721C13.9853 15.2126 14.0331 15.1328 14.0331 15.1328C14.0331 15.1328 14.1083 15.1761 14.2587 15.2627C14.4046 15.3493 14.4775 15.3926 14.4775 15.3926C14.4775 15.3926 14.4319 15.4723 14.3408 15.6318ZM13.8896 15.3721C13.7984 15.5361 13.7529 15.6182 13.7529 15.6182C13.7529 15.6182 13.6777 15.5749 13.5273 15.4883C13.3769 15.4017 13.3017 15.3584 13.3017 15.3584C13.3017 15.3584 13.3473 15.2764 13.4384 15.1123C13.5341 14.9528 13.582 14.873 13.582 14.873C13.582 14.873 13.6572 14.9163 13.8076 15.0029C13.9579 15.0895 14.0331 15.1328 14.0331 15.1328C14.0331 15.1328 13.9853 15.2126 13.8896 15.3721ZM14.621 15.1465C14.5253 15.3105 14.4775 15.3926 14.4775 15.3926C14.4775 15.3926 14.4046 15.3493 14.2587 15.2627C14.1083 15.1761 14.0331 15.1328 14.0331 15.1328C14.0331 15.1328 14.0787 15.0508 14.1699 14.8867C14.2656 14.7272 14.3134 14.6475 14.3134 14.6475C14.3134 14.6475 14.3886 14.6908 14.539 14.7773C14.6848 14.8639 14.7577 14.9072 14.7577 14.9072C14.7577 14.9072 14.7122 14.987 14.621 15.1465ZM14.1699 14.8867C14.0787 15.0508 14.0331 15.1328 14.0331 15.1328C14.0331 15.1328 13.9579 15.0895 13.8076 15.0029C13.6572 14.9163 13.582 14.873 13.582 14.873C13.582 14.873 13.6275 14.791 13.7187 14.627C13.8144 14.4674 13.8622 14.3877 13.8622 14.3877C13.8622 14.3877 13.9374 14.431 14.0878 14.5176C14.2382 14.6042 14.3134 14.6475 14.3134 14.6475C14.3134 14.6475 14.2656 14.7272 14.1699 14.8867Z" fill="#1E90FF"/>
      </svg>
  </div>
    <div class="search-box">
      <form class='search__form'>
        <svg viewBox="0 0 24 24" class="search__icon">
          <g><path d="M21.53 20.47l-3.66-3.66C19.195 15.24 20 13.214 20 11c0-4.97-4.03-9-9-9s-9 4.03-9 9 4.03 9 9 9c2.215 0 4.24-.804 5.808-2.13l3.66 3.66c.147.146.34.22.53.22s.385-.073.53-.22c.295-.293.295-.767.002-1.06zM3.5 11c0-4.135 3.365-7.5 7.5-7.5s7.5 3.365 7.5 7.5-3.365 7.5-7.5 7.5-7.5-3.365-7.5-7.5z"></path></g>
        </svg>
        <input [(ngModel)]='searchTerm' #search (keyup)='searchPatient(searchTerm)' type="search" name="search" autocomplete="off" placeholder='Search Patient' class='form-control input search'>
      </form>
    </div>
    <div class="view-box">
      <div *ngIf=sortMenu  class="sort__options">
        <ul class='list__options' (mouseleave)='toggleSortMenu()'>
          <li (click)='sortPatients("A-Z")' class="action">A-Z</li>
          <li (click)='sortPatients("Age")' class="action">Age</li>
          <li (click)='sortPatients("Gender")' class="action">Gender</li>
          <li (click)='sortPatients("Date")' class="action">Date</li>
      </ul>
      </div>
      <h6>Sort:
        <span style='cursor:pointer' (click) ='toggleSortMenu()'>{{nowSorting}}</span>
      </h6>
      <div  class="add__patient__box">

      </div>
    </div>
  </nav>
  <div (mouseleave) = hideLogOut() class="log__box">
    <div (click) ='showLogOut()' [ngStyle] = getBackgrounds() class="dp__box"></div>
    <div *ngIf="logout" class="log__out">
      <ul class='list__options'>
        <li (click)=logOut()>
            Log out
        </li>
    </ul>
    </div>
    <i (click) ='showLogOut()' class="icon ion-ios-arrow-down"></i>
  </div>
</header>

<div style="padding-top:60px" class="container">
    <div style=position:absolute id="more" (click) = onScroll() ></div>
    <div class="row">
        <div *ngIf='!patients.length' class='issue'>
            <div *ngIf='loading' class="spinner main"></div>
            <div (click)='refresh()' *ngIf='message' title='Refresh' class='refresh'><i class="icon ion-ios-reload "></i></div>
            <h6 *ngIf='message' style='font-size:13px;position:absolute;top:65%; width:100%; color:lightgrey;text-align: center'>{{message}}</h6>
        </div>
        <div *ngFor="let patient of patients; let i = index" class="col-xl-4 col-lg-4 col-md-4 col-sm-6 col-xs-12">
                <div style="overflow: hidden;"  class="card card-secondary maincard">
                    <div *ngIf="patient.card.view!=='front'" style='padding-left: 37px;   border-top-right-radius: 12px; border-top-left-radius: 12px; padding-top: 0px;
                    position:absolute; width:100%; padding-bottom: 0px;height:32px' class="card-header profileheader small-header">
                        <i (click)="switchCardView(i,'front')" style='position:absolute;  left:3%;top:4px; cursor:pointer;
                        display: inline-block;
                        color:#1da1f2;' title="Back" class="icon ion-android-arrow-back">
                        </i>
                        <div style="left:23px;position: absolute;" class="timeline lastdoc priscriber headerdp small-dp">
                            <img [src]='getDp(patient.info.personal.avatar)'/>
                        </div>
                        <p style="top:6px;margin-bottom:0px;position: absolute;" class="patien-name small-name">
                            {{patient.info.personal.firstName + ' '+ patient.info.personal.lastName}}<span class="small-headericon"></span>
                        </p>
                    </div>
                    <div [class.ap]='cardCount' [class.front]='patient.card.view === "front"' style="position: absolute; width:100%;height: 87%;top:13%" class="card-body mainbody">
                        <div style="position: relative;margin-bottom: 0px;top:0px" class="timeline lastdoc priscriber headerdp">
                            <img  [src]='getDp(patient.info.personal.avatar)'/>
                            <div *ngIf="patient.card.indicate" class="indicator"></div>
                        </div>
                        <p  title="View Details" style='margin-bottom:2px;position:relative;top:3px' class="patien-name display-name">
                            {{patient.info.personal.firstName + ' '+patient.info.personal.lastName}}
                        </p>
                        <div>
                            <div style="position: relative;top:12px" class="carditem basic-item">
                                <h6 class="dept basic-info">Sex</h6>
                                <h6 class="dept basic-info sex-info">
                                    {{patient.info.personal.gender.charAt(0).toUpperCase()}}
                                </h6>
                            </div>
                            <div style="position: relative;top:12px" class="carditem basic-item">
                                <h6 class="dept basic-info">Age</h6>
                                <h6 class="dept basic-info sex-info">{{patient.info.personal.dob|dob}}</h6>
                            </div>
                            <div style="top: 10px;" class="carditem basic-item">
                                <h6 class="dept basic-info">Seen</h6>
                                <h6 class="dept basic-info sex-info">{{patient.record.visits.length}}</h6>
                            </div>
                            <div style="top:-3px" class="priscription basic-subinfo">
                                <div  class="sub-container">
                                    <h6 style="width:100%;text-align:center" class="dept basic-secondary basic-value">
                                        {{patient.record.invoices[0][0].stamp.dateAdded|date:'dd-MM-y'}}&nbsp;
                                        <span>
                                            {{patient.record.invoices[0][0].stamp.dateAdded|date:'hh:mma'|lowercase}}
                                        </span>
                                    </h6>
                                </div>
                            </div>
                        </div>
                        <button   (click)='viewOrders(i)'  data-toggle="modal" data-target="#billingModal" style=" width: 120px;font-size: 10px; height:27px;left: 26%;
                        bottom: 10%;" class="btn btn-sm btn-outline-primary mainbtn">INVOICES</button>
                        <!-- <button *ngIf="!patients[i].record.cards[0].pin"  (click)="switchCardView(i,'card')"   style=" width: 120px;font-size: 10px; height:27px;left: 26%;bottom: 10%;" class="btn btn-sm btn-outline-primary mainbtn"> ASSIGN CARD </button> -->
                    </div>
                    <!-- <div [class.on]='patient.card.view === "card"'   style="position: absolute; width:100%;height: 87%; top:13%;background:white;border-bottom-right-radius: 12px;border-bottom-left-radius: 12px" class="card-body mainbody off">
                        <form style="top:25%;position:absolute;width:100%; padding-left: 8%; padding-right: 8%;" class=" staffsform">
                            <div style=" margin-top:2px;" class="form-group vitals-section formGroup">
                                <label style='font-size:10px;font-weight: bold; color:grey; left: 45px;top:-15%;' for="title" class="labelss complain">
                                    CARD TYPE: &nbsp; <span style='font-size:11px;'>{{card.category}}</span>
                                </label>
                                <input  placeholder="Scan card pin" style='font-size:11px; visibility: hidden; width:100%; padding-left: 5px; border-radius: 0px;border: none;border-bottom: 1px solid whitesmoke;' name="pin" class="patientdata dataInfo ref-dept" >
                            </div>
                            <div style=" margin-top:2px;" class="form-group vitals-section formGroup">
                                <label style='font-size:8px;left: 25px;top:-15%;' for="title" class="labelss complain">
                                    CARD PIN
                                </label>
                                <input [maxLength]='6' [(ngModel)]="card.pin" placeholder="Scan card pin" style='font-size:11px; width:100%; padding-left: 5px; border-radius: 0px;border: none;border-bottom: 1px solid whitesmoke;' name="pin" class="patientdata dataInfo ref-dept" >
                            </div>
                        </form>
                        <button [disabled]='!card.pin || card.pin.length !== 4' (click)='assignCard()'  style=" width: 170px;font-size: 10px; height:27px;left:15%; bottom:17%;" class="btn btn-sm btn-outline-primary  mainbtn">ASSIGN<span *ngIf="processing" style="position: absolute; bottom: -7%;left: 10%;"><i class="fa fa-circle-o-notch fa-spin fa-10x slow-spin" style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;"></i></span>
                        </button>
                    </div> -->
                    <h6 *ngIf='successMsg && curIndex === i' class="feedbackMsg">{{successMsg}}</h6>
                    <h6 *ngIf="errorMsg && curIndex === i"  style="color: red" class="feedbackMsg">{{errorMsg}}</h6>
                </div>
            </div>
        </div>
    </div>


