
<div class="modal fade" role="dialog" tabindex="-1" id="addModal" style="border-radius:32px;max-width:841px;margin: auto;padding-top: 35px">
        <div style="max-width: 730px;border-radius:32px;" class="modal-dialog" role="document">
            <div class="modal-content" style="width:100%; height:400px;border-radius:32px;padding-left:0px;padding-right: 0px;">
                <div class="modal-body" style="border-radius:32px;padding: 0px;">
                    <div class="card card-secondary historycard midlecard profilecard" style="margin:auto;min-height:400px;border-radius:32px;width:100%;position: absolute">
                        <div  data-dismiss="modal" style="height: 25px; width:25px; top:3%; cursor: pointer;  color: white(248, 248, 248); background:rgba(193, 193, 224, 0.2)" class="close-comment">
                            <i  title="close" class="icon ion-ios-close-empty"></i>
                        </div>
                        <div class="card-body orderbody" style="width:85%; margin:auto; padding-top:30px">
                          <div style ='top:20px' class="steps">
                              <div (click) = goTo(0)  [class.curent-step] = 'count === 0' class="step-item">
                                  <span>
                                      <h6 class="step-lebel">PERONAL INFO</h6>
                                  </span>
                                  <span *ngIf=" isValidInfo()">
                                      <i  class="icon ion-ios-checkmark-empty paid-icon"></i>
                                  </span>
                              </div>
                              <div (click) = goTo(1)  [class.curent-step] = 'count === 1' class="step-item">
                                  <span>
                                      <h6 class="step-lebel">CONTACT</h6>
                                  </span>
                                  <span >
                                      <i *ngIf=" isValidContact()" class="icon ion-ios-checkmark-empty paid-icon"></i>
                                  </span>
                              </div>
                              <div (click) = goTo(2) [class.curent-step] = 'count === 2' class="step-item">
                                  <span>
                                      <h6 style="width:94px;" class="step-lebel">INSURANCE</h6>
                                  </span>
                              </div>
                            </div>
                            <form *ngIf="count===0" class="staffsform reg-form">
                                <div class ='group-wrap'>
                                    <div class="form-group">
                                        <label  for="firstname" class="labelss"><span style='font-size:11px; color:red;'>*</span>FIRST NAME
                                        </label>
                                        <input #f
                                        (focus)="showSuggestions(f.name)"
                                        (keyup)= 'searchMatch(f.value, f.name)'
                                        [(ngModel)]="patient.info.personal.firstName"
                                        autocomplete="off"
                                        name="firstname"
                                        class="form-control input">
                                        <div *ngIf="elem==='firstname' && matches.length"  class="prisOption slideIn">
                                          <ul data-simplebar class="itemsList" >
                                              <li *ngFor="let match of matches">
                                                  <p (click)='pickMatch(match)' class="drugItem">{{match}}<span class="lastdept timetaken "></span>
                                                  </p>
                                              </li>
                                          </ul>
                                      </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="lastname" class="labelss"><span style='font-size:11px; color:red;'>*</span>LAST NAME </label>
                                        <input #l
                                        (focus)="showSuggestions(l.name)"
                                        (keyup) = 'searchMatch(l.value, l.name)'
                                        [(ngModel)]="patient.info.personal.lastName"
                                        autocomplete="off"
                                        name="lastname"
                                        class="form-control input">
                                        <div *ngIf="elem==='lastname' && matches.length"  class="prisOption slideIn">
                                          <ul data-simplebar class="itemsList" >
                                              <li *ngFor="let match of matches">
                                                  <p (click)='pickMatch(match)' class="drugItem">{{match}}<span class="lastdept timetaken "></span>
                                                  </p>
                                              </li>
                                          </ul>
                                      </div>
                                    </div>
                                </div>
                                <div class ='group-wrap'>
                                    <div class="form-group">
                                        <label  for="gender" class="labelss">GENDER</label>
                                        <select id = select (focus) = clearError() name='gender' [(ngModel)]=" patient.info.personal.gender"  autocomplete="off" class="form-control input">
                                            <option>Male</option>
                                            <option>Female</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label  for="status" class="labelss">MARITAL STATUS</label>
                                        <select id = select (focus) = clearError() name='status' [(ngModel)]=" patient.info.personal.mstatus" autocomplete="off" class="form-control input" >
                                            <option>Married</option>
                                            <option>Single</option>
                                        </select>
                                    </div>
                                </div>
                                <div class ='group-wrap'>
                                    <div class="form-group">
                                        <label  for="dob" class="labelss"><span style='font-size:11px; color:red;'>*</span>DATE OF BIRTH</label>
                                        <input (focus) = clearError() name='dob' [(ngModel)]=" patient.info.personal.dob" type="date" autocomplete="off" class="form-control input" />
                                    </div>
                                    <div class="form-group">
                                        <label  for="tribe" class="labelss">TRIBE</label>
                                        <input (focus) = clearError() name='tribe' [(ngModel)]=" patient.info.personal.tribe"   autocomplete="off" class="form-control input" />
                                    </div>
                                </div>
                                <div class ='group-wrap'>
                                    <div class="form-group">
                                        <label  for="religion" class="labelss">RELIGION</label>
                                        <select id = select (focus) = clearError() name='religion' [(ngModel)]=" patient.info.personal.religion" autocomplete="off" class="form-control input">
                                            <option>Islam</option>
                                            <option>Christianity</option>
                                            <option>Others</option>
                                        </select>
                                    </div>
                                    <div class="form-group" >
                                        <label for="occupation" class="labelss">OCCUPATION</label>
                                        <select id = select  (focus) = clearError() name='occupation' [(ngModel)]=" patient.info.personal.occupation" autocomplete="off" class="form-control input">
                                            <option>Civil Servant</option>
                                            <option>Entreprenure</option>
                                            <option>Farmer</option>
                                            <option>House Wife</option>
                                            <option>Applicant</option>
                                            <option>Student</option>
                                            <option>Others</option>
                                        </select>
                                    </div>
                                </div>
                                <!-- <div *ngIf=reg class="form-group">
                                  <label  for="address" class="labelss">DATE ENROLED</label>
                                  <input [(ngModel)]='patient.info.stamp.dateAdded' type = 'date' (focus) = clearError() autocomplete="off" name="address" class="form-control input" />
                              </div> -->
                              <!-- <div *ngIf=!reg class ='group-wrap'>
                                  <div   class="form-group ">
                                    <label  for="enroled" class="labelss"><span style='font-size:11px; color:red;'>*</span>DATE ENROLED</label>
                                    <input [(ngModel)]='patient.info.stamp.dateAdded  'type="date" (focus) = clearError()  autocomplete="off" name="enroled" class="form-control input   "/>
                                  </div>
                                  <div  class="form-group">
                                      <label  for="firstname" class="labelss"><span style='font-size:11px; color:red;'>*</span>CARD NUMBER
                                      </label>
                                      <input  (focus) = clearError() autocomplete="off"  name="firstname" class="form-control input">
                                  </div>
                                </div> -->
                              </form>
                              <form *ngIf="count === 1" class="staffsform reg-form">
                                <div class ='group-wrap'>
                                  <div class="form-group">
                                      <label  for="mobile" class="labelss">MOBILE</label>
                                      <input (focus) = clearError() name='mobile' [(ngModel)]=" patient.info.contact.me.mobile"       autocomplete="off" class="form-control input" />
                                  </div>
                                  <div class="form-group">
                                      <label  for="email" class="labelss">EMAIL</label>
                                      <input (focus) = clearError() name='email' [(ngModel)]=" patient.info.contact.me.email"       autocomplete="off" class="form-control input" />
                                  </div>
                                </div>
                                <div class ='group-wrap'>
                                  <div class="form-group" >
                                      <label  for="state" class="labelss">STATE</label>
                                      <select id = select (focus) = clearError() name='state' [(ngModel)]=" patient.info.contact.me.state"      autocomplete="off" class="  form-control input">
                                          <option *ngFor='let state of states'>
                                              {{state}}
                                          </option>
                                      </select>
                                  </div>
                                  <div class="form-group">
                                      <label  for="lga" class="labelss">CITY</label>
                                      <select id = select  (focus) = clearError() name='lga' [(ngModel)]=" patient.info.contact.me.lga"      autocomplete="off" class=" form-control input">
                                          <option *ngFor='let lga of  getLgas()'>
                                              {{lga}}
                                          </option>
                                      </select>
                                  </div>
                                </div>
                                <div class="form-group">
                                    <label  for="address" class="labelss">ADDRESS</label>
                                    <input (focus) = clearError() [(ngModel)]=" patient.info.contact.me.address" autocomplete="off"  name="address" class="form-control input"/>
                                </div>
                                <div class ='group-wrap'>
                                    <div class="form-group">
                                        <label  for="statee" class="labelss">NEXT OF KIN NAME</label>
                                        <input (focus) = clearError() name='kinname' [(ngModel)]=" patient.info.contact.me.kinName"   autocomplete="off" class="form-control input" />
                                    </div>
                                    <div class="form-group">
                                        <label  for="lga" class="labelss">NEXT OF KIN MOBILE</label>
                                        <input (focus) = clearError() name='kinmobile' [(ngModel)]=" patient.info.contact.me.kinMobile" autocomplete="off" class="form-control input"/>
                                    </div>
                                </div>

                                <div class ='group-wrap'>
                                    <div class="form-group">
                                        <label  for="ename" class="labelss">EMERGENCY CONTACT NAME</label>
                                        <input (focus) = clearError() name='ename' [(ngModel)]=" patient.info.contact.emergency.name"  autocomplete="off" class="form-control input"/>
                                    </div>
                                    <div class="form-group">
                                        <label  for="emobile" class="labelss">EMERGENCY MOBILE</label>
                                        <input (focus) = clearError() name='emobile' [(ngModel)]=" patient.info.contact.emergency.mobile" autocomplete="off" class="form-control input"/>
                                    </div>
                                </div>
                              </form>

                              <form *ngIf="count===2" class="staffsform reg-form">
                                <div class ='group-wrap'>
                                    <div class="form-group">
                                        <label  for="gnumb" class="labelss">GROUP No.</label>
                                        <input (focus) = clearError() [(ngModel)]=" patient.info.insurance.groupNo" name='gnumb' autocomplete="off" class="form-control input "/>
                                    </div>
                                    <div class="form-group">
                                        <label  for="idnum" class="labelss">ID No.</label>
                                        <input (focus) = clearError() [(ngModel)]=" patient.info.insurance.idNo" name='idnum' autocomplete="off" class="form-control input"/>
                                    </div>
                                </div>
                                <div class="group-wrap">
                                    <div class="form-group">
                                        <label  for="sub" class="labelss">HMO</label>
                                        <input (focus) = clearError() [(ngModel)]=" patient.info.insurance.subscriber" name='sub' autocomplete="off" class="form-control input"/>
                                    </div>
                                    <div class="form-group">
                                        <label  for="employer" class="labelss">EMPLOYER</label>
                                        <input (focus) = clearError() [(ngModel)]="patient.info.insurance.employer" name='employer' autocomplete="off" class="form-control input"/>
                                    </div>
                                </div>
                                <div class="group-wrap">
                                    <div class="form-group" >
                                        <label  for="ssn" class="labelss">SSN</label>
                                        <input (focus) = clearError() [(ngModel)]=" patient.info.insurance.ssn" name='ssn'autocomplete="off" class="form-control input"/>
                                    </div>
                                    <div class="form-group">
                                        <label  for="irel" class="labelss">RELATIONSHIP</label>
                                        <select id = select  (focus) = clearError() [(ngModel)]=" patient.info.insurance.rel" name='irel' autocomplete="off" class="form-control  input">
                                            <option>Parent</option>
                                            <option>Spouse</option>
                                            <option>Self</option>
                                            <option>Sibling</option>
                                            <option>Other</option>
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div style="left:12%; top:45%;position: absolute;
                    width: 7%;" class="btn-group disposition">
                        <button [disabled]='count === 0' (click) = prev() style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo shift-button" >
                            <i style='
                            position:absolute;
                            right:36%;
                            top:2px;
                            font-size:large;
                            cursor:pointer;
                            display: inline-block;'
                            title="Back"
                            class="icon ion-android-arrow-back">
                            </i>
                        </button>
                    </div>
                    <div style="left: 76%; top:45%;position: absolute;
                    width: 7%;" class="btn-group disposition">
                        <button [disabled]='count === 2'(click)=next() style="width:32px;height: 32px;border-radius: 50%;left:35%"   class="btn btn-outline-primary  dispo shift-button ">
                            <i style='position:absolute;right:36%;top:2px; font-size:large; cursor:pointer; display: inline-block;' title="Next" class="icon ion-android-arrow-forward ">
                            </i>
                        </button>
                    </div>
                    <div *ngIf="count === 2 &&  reg" style="left:31%;top:72%;position:relative;width:53%" class="btn-group disposition">
                      <button
                      (click)=addRecord() [disabled] = "creating || isInvalidForm()"
                      style=" width:170px;font-size: 10px; border-radius: 30px; height:27px;left:15%; bottom:10%;" class="btn btn-sm btn-outline-primary mainbtn">
                          <div *ngIf="creating" class='spinner small'></div>
                          <span *ngIf='!creating' >CREATE RECORD</span>
                      </button>
                    </div>
                    <div *ngIf="count === 2 && !reg"
                    style="left:31%;top:72%;position:relative;width:53%"
                    class="btn-group disposition">
                      <button
                      (click) = updateInfo() [disabled] = "updating || isInvalidForm()"
                      style=" width:170px;font-size: 10px; border-radius: 30px; height:27px;left:15%; bottom:10%;" class="btn btn-sm btn-outline-primary mainbtn">
                          <div *ngIf="processing" class='spinner small'></div>
                          <span *ngIf=' !updating' >UPDATE RECORD</span>
                      </button>
                    </div>
                    <h6 *ngIf=" successMsg" class="feedbackMsg">{{successMsg}}</h6>
                    <h6 *ngIf=" errorMsg"  style="color: red" class="feedbackMsg">{{errorMsg}}</h6>
                </div>
            </div>
        </div>
    </div>


    <div  class="modal fade" role="dialog" tabindex="-1" id="staffModal" style="border-radius:32px;max-width:841px;margin: auto;padding-top: 35px">
      <div style="max-width: 615px;border-radius:32px;" class="modal-dialog" role="document">
          <div class="modal-content" style="width:100%; height:280px; border-radius:32px;padding-left:0px;padding-right: 0px;">
              <div class="modal-body" style="border-radius:32px;padding: 0px;">
          </div>
          <div  class="card card-secondary historycard midlecard profilecard" style="margin:auto;min-height:240px;border-radius:12px;border-bottom:none;">
              <div data-dismiss="modal" style="height: 25px; width:25px; left: 104%; top:3%; cursor: pointer;  color: white(248, 248, 248); background:rgba(193, 193, 224, 0.2)" class="close-comment">
                  <i title="close" class="icon ion-ios-close-empty"></i>
              </div>
              <div style='width:100%;padding-left: 30px;position:absolute;top:-11%; border-top-right-radius:12px;border-top-left-radius:12px; border-bottom:0px' class="card-header profileheader small-header">
                  <h6 style='font-size:11px;position:absolute; top:12px;left:-4%;color:#1da1f2;' class="patien-name small-name">PATIENT DETAILS</h6>
                  <i  class="icon ion-android-more-vertical headericon moreicon actions-icon"></i>
              </div>
              <div style='margin-left:0px;padding-top: 22px;' class="card-body orderbody">
                  <form style="top:15%; width:56%;margin:auto;" class=" staffsform">
                      <div class="carditem noteitem writeup" style="display:inline-block;">
                          <div title='Details' data-toggle=modal data-target='#editModal' class="timeline noter patientdp staffdp" style="border-radius:4px;width:130px; height:130px; position:absolute">
                              <img style='height:100%; width:100%; object-fit:cover; border-radius:4px;border:none' [src]=getDp(patients[2].info.personal.avatar)/>
                          </div>
                          <div style='position:absolute;left:50%;width:80%'>
                              <h1 class="dept previnfo noterinfo">
                                  Mohammed Ibrahim
                              </h1>
                              <h1 class="dept previnfo ">
                                  Gender:&nbsp;
                                  <span class="predata">Male</span>
                              </h1>
                              <h1 class="dept previnfo">
                                  Age:&nbsp;<span class="predata">45</span>
                              </h1>
                              <h1 class="dept previnfo">
                                  Marital Status:&nbsp;<span class="predata">Married</span>
                              </h1>
                              <h1 class="dept previnfo">Address:&nbsp;
                                  <span class="predata">No.44 Somet St Lagos</span>
                              </h1>
                              <h1 class="dept previnfo">
                                  Religion&nbsp;<span class="predata">Islam</span>
                              </h1>
                              <h1 class="dept previnfo">Occupation:&nbsp;
                                  <span class="predata">Civil Servant</span>
                              </h1>
                              <h1 class="dept previnfo">Blood Group:&nbsp;
                                  <span class="predata">O+&nbsp;</span>
                                  <span class="predata"></span>
                              </h1>
                              <h1 class="dept previnfo">Date Created:&nbsp;
                                  <span class="predata">June 11, 2019&nbsp;</span>
                                  <!-- <span class="predata">{{staff.createdAt|date:'hh:mma'|lowercase}} </span> -->
                              </h1>
                          </div>
                      </div>
                  </form>
              </div>
          </div>
     </div>
    </div>
</div>












<header class="header-main">
  <nav>
    <div class="logo-box">
      <a href="/"><h1 class="logo">{{appName}}</h1></a>
    </div>
    <div class="search-box">
      <form class='search__form'>
        <svg viewBox="0 0 24 24" class="search__icon">
          <g><path d="M21.53 20.47l-3.66-3.66C19.195 15.24 20 13.214 20 11c0-4.97-4.03-9-9-9s-9 4.03-9 9 4.03 9 9 9c2.215 0 4.24-.804 5.808-2.13l3.66 3.66c.147.146.34.22.53.22s.385-.073.53-.22c.295-.293.295-.767.002-1.06zM3.5 11c0-4.135 3.365-7.5 7.5-7.5s7.5 3.365 7.5 7.5-3.365 7.5-7.5 7.5-7.5-3.365-7.5-7.5z"></path></g>
        </svg>
        <input [(ngModel)]='searchTerm' #search (keyup)='searchPatient(searchTerm)' type="search" name="search" autocomplete="off" placeholder='Search Patient' class='form-control input search'>
      </form>
    </div>
    <div class="view-box">
      <div *ngIf=sortMenu  class="sort__options">
        <ul class='list__options' (mouseleave)='toggleSortMenu()'>
          <li (click)='sortPatients("A-Z")' class="action">A-Z</li>
          <li (click)='sortPatients("Age")' class="action">Age</li>
          <li (click)='sortPatients("Gender")' class="action">Gender</li>
          <li (click)='sortPatients("Date")' class="action">Date</li>
      </ul>
      </div>
      <h6>Sort:
        <span style='cursor:pointer' (click) ='toggleSortMenu()'>{{nowSorting}}</span>
      </h6>
      <div *ngIf='isInfo()' class="add__patient__box add__box">
        <i (click) = clearPatient() style="left:75%;" class="icon ion-ios-plus-empty" title="Add Patient" data-target="#addModal" data-toggle="modal"></i>
      </div>
    </div>
  </nav>
  <div (mouseleave) = hideLogOut() class="log__box">
    <div (click) ='showLogOut()' [ngStyle] = getBackgrounds() class="dp__box"></div>
    <div *ngIf="logout" class="log__out">
      <ul class='list__options'>
        <li (click)=logOut()>
            Log out
        </li>
      </ul>
    </div>
    <i (click) = 'showLogOut()' class="icon ion-ios-arrow-down"></i>
  </div>
</header>


<div style="padding-top:60px" class="container">
    <div class="row no-gutters justify-content-center">
    <div style=position:absolute id="more" (click) = onScroll() ></div>
        <div *ngIf='!patients.length' class='issue'>
            <div *ngIf=loading  class="spinner main"></div>
            <div (click)=refresh() *ngIf='message' title='Refresh' class='refresh'>
                <i class="icon ion-ios-reload "></i>
            </div>
            <h6 class='errMsg' *ngIf='message'>{{message}}</h6>
        </div>
        <div *ngFor="let patient of patients; let i=index" class="col-xl-4 col-lg-4 col-md-4 col-sm-6 col-xs-12">
          <div style="left: 62%" (mouseleave)='hideMenu()' *ngIf="patient.card.menu" class="menu">
            <ul  class="actions primary">
                 <li (click)="switchCardView(i,'enrole')" class="action">Enrole</li>
                 <li (click)="switchCardView(i,'return')" class="action">Return Folder</li>
                 <li (click)='viewDetails(i)' data-toggle="modal" data-target="#addModal" class="action">
                     Edit Info
                 </li>
             </ul>
          </div>
        <div (mouseenter) = showMoreIcon(i) (mouseleave) = hideMoreIcon(i) style="overflow: hidden;"  class="card card-secondary maincard">
            <div *ngIf="patient.card.view==='front'"
            class="card-header profileheader p-header">
              <div (click)='showMenu(i)' title="More" *ngIf="isInfo() && patient.card.more" class="more-wrap">
                <i class="icon ion-android-more-vertical"></i>
              </div>
            </div>
            <div  *ngIf="patient.card.view!=='front'" class="card-header profileheader small-header s-header">
                <i (click)="switchCardView(i,'front')"
                  style='position:absolute; left:3%;top:4px; cursor:pointer;
                  display: inline-block;
                  color:#1da1f2;'
                  title="Back"
                  class="icon ion-android-arrow-back">
                </i>
                <div style="left:23px;position: absolute;" class="timeline lastdoc priscriber headerdp small-dp">
                    <img [src]='getDp(patient.info.personal.avatar)'/>
                </div>
                <p style="top:6px;margin-bottom:0px;position: absolute;" class="patien-name small-name">
                    {{patient.info.personal.firstName +' '+ patient.info.personal.lastName}}<span class="small-headericon"></span>
                </p>
            </div>
            <div [class.ap]='cardCount' [class.front]='patient.card.view === "front"' style="position: absolute; width:100%;height: 87%;top:13%" class="card-body mainbody">
                <div  style="position: relative;margin-bottom: 0px;top:0px" class="timeline lastdoc priscriber headerdp">
                  <img [src]='getDp(patient.info.personal.avatar)'/>
                </div>
                <p (click)='viewDetails(i)' data-toggle="modal" data-target="#addModal" *ngIf="isInfo() || isWard()"
                    style='margin-bottom:2px;position:relative;top:3px'
                    class="patien-name display-name"> <span>{{patient.info.personal.firstName}} </span>
                    {{patient.info.personal.lastName}}
                </p>
                <a style="position:relative;top:3px" *ngIf='isConsult()' href="#" title="View history" [routerLink]="['../history', patient._id]" routerLinkActive="router-link-active" class="patien-name">
                   <span>{{patient.info.personal.firstName}} </span>{{patient.info.personal.lastName}}
                    </a>
                    <a style="position:relative;top:3px" *ngIf='isAdmin()' href="#" title="View history" [routerLink]="['./history', patient._id]" routerLinkActive="router-link-active" class="patien-name">
                    <span >{{patient.info.personal.firstName}} </span> 
                        {{patient.info.personal.lastName}}
                    </a>
                <div>
                    <div style="position: relative;top:12px" class="carditem basic-item">
                        <h6 class="dept basic-info">Sex</h6>
                        <h6 class="dept basic-info sex-info">
                            {{patient.info.personal.gender.charAt(0).toUpperCase()}}
                        </h6>
                    </div>
                    <div style="position: relative;top:12px" class="carditem basic-item">
                        <h6 class="dept basic-info">Age</h6>
                        <h6 class="dept basic-info sex-info">{{patient.info.personal.dob|dob}}</h6>
                    </div>
                    <div style="position: relative;top:12px" class="carditem basic-item">
                        <h6 class="dept basic-info">Seen</h6>
                        <h6 class="dept basic-info sex-info">{{countVisits(i).length ||'---'}}</h6>
                    </div>
                </div>
                <div style="top:0px" *ngIf='!countVisits(i).length ' class="priscription basic-subinfo">
                        <div class="sub-container">
                            <h6 style="font-size: 10px;" class="dept basic-secondary basic-value">
                                CREATED
                            </h6>
                        </div>
                        <div class="sub-container">
                            <h6 style="width:100%;text-align:center" class="dept basic-secondary basic-value">
                                {{patient.createdAt|date:'dd-MM-y'}}&nbsp;
                                <span>{{patient.createdAt|date:'hh:mma'|lowercase}}</span>
                            </h6>
                        </div>
                    </div>
                    <div style="top:0px" *ngIf='countVisits(i).length ' class="priscription basic-subinfo">
                        <div class="sub-container">
                            <h6 style="font-size: 10px;" class="dept basic-secondary basic-value">DISCHARGED</h6>
                        </div>
                        <div class="sub-container">
                            <h6 style="width:100%;text-align:center;" class="dept basic-secondary basic-value">
                                {{patient.record.visits[0][0].dischargedOn|date:'dd-MM-y'}}&nbsp;
                                <span>{{patient.record.visits[0][0].dischargedOn|date:'hh:mma'|lowercase}}</span>
                            </h6>
                        </div>
                    </div>
                </div>

                <div [class.on]='patient.card.view === "enrole"'   style="position: absolute; width:100%;height: 87%; top:13%;background:white;border-bottom-right-radius: 12px;border-bottom-left-radius: 12px" class="card-body mainbody off">
                    <form  style="top:15%;position:absolute;width:100%; padding-left: 10%; padding-right: 10%;" class=" staffsform">
                    <!-- <div style=" margin-top:2px;" class="form-group   formGroup">
                            <label style='font-size:8px;left: 25px;top:-15%;' for="title" class="labelss complain">
                                CARD NUMBER
                            </label>
                            <input autocomplete="off" (focus)='clearError()' [maxLength]='4' [(ngModel)]="pin" placeholder="Scan card pin" name="cardpin" class="form-control input">
                        </div> -->
                        <div style=" margin-top:2px;" class="form-group   formGroup">
                            <label style='font-size:8px;left: 25px;top:-15%;' for="title" class="labelss complain">DEPARTMENT</label>
                            <select id = select [(ngModel)]="visit.dept"  name="dept" class="form-control input" >
                                <option *ngFor="let dept of getRefDept()">{{dept.name}}</option>
                            </select>
                        </div>
                    </form>
                    <button [disabled]='!visit.dept' (click)='enrolePatient(i)' style=" width: 170px;font-size: 10px; height:27px;left:15%; bottom:25%;" class="btn btn-sm btn-outline-primary  mainbtn">
                        ENROLE
                        <span *ngIf="processing"  style="position: absolute; bottom: -7%;left: 76%;">
                        <i class="fa fa-circle-o-notch fa-spin fa-10x slow-spin " style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;"> </i>
                    </span>
                    </button>
                </div>


                <div [class.on]='patient.card.view === "return"'   style="position: absolute; width:100%;height: 87%; top:13%;background:white;border-bottom-right-radius: 12px;border-bottom-left-radius: 12px" class="card-body mainbody off">
                    <form  style="top:15%;position:absolute;width:100%; padding-left: 10%; padding-right: 10%;" class=" staffsform">
                        <div style=" margin-top:2px;" class="form-group   formGroup">
                            <label style='font-size:8px;left: 25px;top:-15%;' for="title" class="labelss complain">DEPARTMENT</label>
                            <select id=select [(ngModel)]="visit.dept" name="dept" class="form-control input" >
                                <option *ngFor="let dept of getRefDept()">{{dept.name}}</option>
                            </select>
                        </div>
                    </form>
                    <button  (click)='returnFolder(i)' style=" width: 170px;font-size: 10px; height:27px;left:15%; bottom:25%;" class="btn btn-sm btn-outline-primary  mainbtn">
                        RETURN FOLDER
                        <span *ngIf="processing"  style="position: absolute; bottom: -7%;left: 76%;">
                        <i class="fa fa-circle-o-notch fa-spin fa-10x slow-spin " style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;"> </i>
                    </span>
                    </button>
                </div>



                <!-- <div [class.on]='patient.card.view === "card"'   style="position: absolute; width:100%;height: 87%; top:13%;background:white;border-bottom-right-radius: 12px;border-bottom-left-radius: 12px" class="card-body mainbody off">
                    <form  style="top:15%;position:absolute;width:100%; padding-left: 10%; padding-right: 10%;" class=" staffsform">
                        <div style=" margin-top:2px;" class="form-group   formGroup">
                            <label style='font-size:8px;left: 25px;top:-15%;' for="title" class="labelss complain">
                                CART TYPE
                            </label>
                            <select id="select" (change)='clearPin()' name='cardtype' [(ngModel)]="card.category"      autocomplete="off" class=" form-control input">
                                <option *ngFor="let name of cardTypes">
                                    {{name}}
                                </option>
                            </select>
                        </div>
                        <div  style=" margin-top:2px;" class="form-group   formGroup">
                            <label style='font-size:8px;left: 25px;top:-15%;' for="title" class="labelss complain">
                                CARD NUMBER
                            </label>
                            <input [(ngModel)]="card.pin" placeholder="scan card pin" style='font-size:11px; width:100%; padding-left: 5px;'  name="pin" class="  form-control input" >
                        </div>
                        <div style ='position: absolute; top: 107%; right: 11%; width: 83%;' class="btn-group disposition">
                            <button (click)="markEntry('new')" style="width:112px; font-size:10px" [class.active]='entry==="new"' class="btn btn-outline-primary  dispo " >NEW</button>
                            <button (click)="markEntry('old')" style="font-size:10px; width:112px;border-top-left-radius: 0px; border-bottom-left-radius: 0px;"
                              [class.active]='entry==="old"' class="btn btn-outline-primary  dispo">OLD
                            </button>
                        </div>
                    </form>
                    <button [disabled]='processing || !entry || !card.pin' (click)='addCard()' style=" width: 170px;font-size: 10px; height:27px;left:15%; bottom:12%;" class="btn btn-sm btn-outline-primary  mainbtn">ADD CARD<span *ngIf="processing" style="position: absolute; bottom: -7%;left: 10%;">
                        <i class="fa fa-circle-o-notch fa-spin fa-10x slow-spin" style="position:absolute;bottom:5px;left:5px;font-size:19px;color: #1da1f2;">
                        </i>
                    </span>
                    </button>
                </div> -->
                <h6 *ngIf="successMsg && curIndex===i" class="feedbackMsg">{{successMsg}}</h6>
                <h6 *ngIf="errorMsg && curIndex===i"  style="color: red" class="feedbackMsg">{{errorMsg}}</h6>
            </div>
        </div>
      </div>
    </div>


